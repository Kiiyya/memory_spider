Honestly, this code is way too complicated for such a simple task, and thus not really maintainable. I am aware of that.
However, it was fun to write and I had a blast.

And, hopefully despite being complex on the inside, the API it exposes should be very simple and versatile. :>!
